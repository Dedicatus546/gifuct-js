!function(e){var r={};function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var a in e)t.d(n,a,function(r){return e[r]}.bind(null,a));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=0)}([function(e,r,t){"use strict";t.r(r),t.d(r,"parseGIF",(function(){return x})),t.d(r,"parseGIFChunked",(function(){return m})),t.d(r,"decompressFrame",(function(){return v})),t.d(r,"decompressFrames",(function(){return b}));var n={};t.r(n),t.d(n,"buildStream",(function(){return s})),t.d(n,"readByte",(function(){return c})),t.d(n,"peekByte",(function(){return d})),t.d(n,"readBytes",(function(){return u})),t.d(n,"peekBytes",(function(){return l})),t.d(n,"readString",(function(){return f})),t.d(n,"readUnsigned",(function(){return p})),t.d(n,"readArray",(function(){return y})),t.d(n,"readBits",(function(){return g}));const a=async(e,r,t={},n=t,i={})=>{if(i.parseBefore&&await i.parseBefore(r,t,n,i),i.terminated)return t;if(Array.isArray(r))for(let o=0;o<r.length;o++){let s=r[o];await a(e,s,t,n,i)}else if("function"==typeof r)await r(e,t,n,a,i);else{const o=Object.keys(r)[0];Array.isArray(r[o])?(n[o]={},await a(e,r[o],t,n[o],i)):n[o]=await r[o](e,t,n,a,i)}return i.parseAfter&&await i.parseAfter(r,t,n,i),t},i=(e,r)=>async(t,n,a,i,o)=>{await r(t,n,a,o)&&await i(t,e,n,a,o)},o=(e,r)=>async(t,n,a,i,o)=>{const s=[];for(;await r(t,n,a,o);){const r={};if(await i(t,e,n,r,o),s.push(r),o.terminated)break}return s},s=e=>({data:e,pos:0}),c=()=>e=>e.data[e.pos++],d=(e=0)=>r=>r.data[r.pos+e],u=e=>r=>r.data.subarray(r.pos,r.pos+=e),l=e=>r=>r.data.subarray(r.pos,r.pos+e),f=e=>r=>Array.from(u(e)(r)).map(e=>String.fromCharCode(e)).join(""),p=e=>r=>{const t=u(2)(r);return e?(t[1]<<8)+t[0]:(t[0]<<8)+t[1]},y=(e,r)=>(t,n,a)=>{const i="function"==typeof r?r(t,n,a):r,o=u(e),s=new Array(i);for(var c=0;c<i;c++)s[c]=o(t);return s},g=e=>r=>{const t=c()(r),n=new Array(8);for(var a=0;a<8;a++)n[7-a]=!!(t&1<<a);return Object.keys(e).reduce((r,t)=>{const a=e[t];return a.length?r[t]=((e,r,t)=>{for(var n=0,a=0;a<t;a++)n+=e[r+a]&&2**(t-a-1);return n})(n,a.index,a.length):r[t]=n[a.index],r},{})};function w({readByte:e,peekByte:r,readBytes:t,peekBytes:n,readString:a,readUnsigned:s,readArray:c,readBits:d}){var u={blocks:async r=>{const n=[];for(var a=0,i=await e()(r);0!==i;i=await e()(r))n.push(await t(i)(r)),a+=i;const o=new Uint8Array(a);for(var s=0,c=0;c<n.length;c++)o.set(n[c],s),s+=n[c].length;return o}};const l=i({gce:[{codes:t(2)},{byteSize:e()},{extras:d({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:s(!0)},{transparentColorIndex:e()},{terminator:e()}]},async e=>{var r=await n(2)(e);return 33===r[0]&&249===r[1]}),f=i({image:[{code:e()},{descriptor:[{left:s(!0)},{top:s(!0)},{width:s(!0)},{height:s(!0)},{lct:d({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},i({lct:c(3,(e,r,t)=>Math.pow(2,t.descriptor.lct.size+1))},(e,r,t)=>t.descriptor.lct.exists),{data:[{minCodeSize:e()},u]}]},async e=>44===await r()(e)),p=i({text:[{codes:t(2)},{blockSize:e()},{preData:async(e,r,n)=>await t(n.text.blockSize)(e)},u]},async e=>{var r=await n(2)(e);return 33===r[0]&&1===r[1]}),y=i({application:[{codes:t(2)},{blockSize:e()},{id:async(e,r,t)=>await a(t.blockSize)(e)},u]},async e=>{var r=await n(2)(e);return 33===r[0]&&255===r[1]}),g=i({comment:[{codes:t(2)},u]},async e=>{var r=await n(2)(e);return 33===r[0]&&254===r[1]});return[{header:[{signature:a(3)},{version:a(3)}]},{lsd:[{width:s(!0)},{height:s(!0)},{gct:d({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:e()},{pixelAspectRatio:e()}]},i({gct:c(3,(e,r)=>Math.pow(2,r.lsd.gct.size+1))},(e,r)=>r.lsd.gct.exists),{frames:o([l,y,g,f,p],async e=>{var t=await r()(e);return 33===t||44===t})}]}var h=w(n);const x=(e,r={})=>{const t=new Uint8Array(e),n={};return a(s(t),h,n,n,r)},m=(e,r,t={})=>{const n={},i=w(r);return a(e,i,n,n,t)},v=(e,r,t)=>{if(!e.image)return void console.warn("gif frame does not have associated image.");const{image:n}=e,a=n.descriptor.width*n.descriptor.height;var i=((e,r,t)=>{const n=t;var a,i,o,s,c,d,u,l,f,p;const y=new Array(t),g=new Array(4096),w=new Array(4096),h=new Array(4097);for(c=(i=1<<(p=e))+1,a=i+2,u=-1,o=(1<<(s=p+1))-1,l=0;l<i;l++)g[l]=0,w[l]=l;var x,m,v,b,A,k;for(x=m=v=b=A=k=0,f=0;f<n;){if(0===b){if(m<s){x+=r[k]<<m,m+=8,k++;continue}if(l=x&o,x>>=s,m-=s,l>a||l==c)break;if(l==i){o=(1<<(s=p+1))-1,a=i+2,u=-1;continue}if(-1==u){h[b++]=w[l],u=l,v=l;continue}for(d=l,l==a&&(h[b++]=v,l=u);l>i;)h[b++]=w[l],l=g[l];v=255&w[l],h[b++]=v,a<4096&&(g[a]=u,w[a]=v,0==(++a&o)&&a<4096&&(s++,o+=a)),u=d}b--,y[A++]=h[b],f++}for(f=A;f<n;f++)y[f]=0;return y})(n.data.minCodeSize,n.data.blocks,a);n.descriptor.lct.interlaced&&(i=((e,r)=>{const t=new Array(e.length),n=e.length/r,a=function(n,a){const i=e.slice(a*r,(a+1)*r);t.splice.apply(t,[n*r,r].concat(i))},i=[0,4,2,1],o=[8,8,4,2];for(var s=0,c=0;c<4;c++)for(var d=i[c];d<n;d+=o[c])a(d,s),s++;return t})(i,n.descriptor.width));const o={pixels:i,dims:{top:e.image.descriptor.top,left:e.image.descriptor.left,width:e.image.descriptor.width,height:e.image.descriptor.height}};return n.descriptor.lct&&n.descriptor.lct.exists?o.colorTable=n.lct:o.colorTable=r,e.gce&&(o.delay=10*(e.gce.delay||10),o.disposalType=e.gce.extras.disposal,e.gce.extras.transparentColorGiven&&(o.transparentIndex=e.gce.transparentColorIndex)),t&&(o.patch=(e=>{const r=e.pixels.length,t=new Uint8ClampedArray(4*r);for(var n=0;n<r;n++){const r=4*n,a=e.pixels[n],i=e.colorTable[a];t[r]=i[0],t[r+1]=i[1],t[r+2]=i[2],t[r+3]=a!==e.transparentIndex?255:0}return t})(o)),o},b=(e,r)=>e.frames.filter(e=>e.image).map(t=>v(t,e.gct,r))}]);